Бином Ньютона в который раз делает камео, с первым появлением в сезоне матанализа и возвращением в алгеме.

Напоминаем, что бином Ньютона - формула раскрытия степени суммы двух переменных, и (в глазах здорового, адекватного человека) выглядит как
$$(a+b)^n = \sum_{k=0}^n \binom n k a^{n-k} b^k$$
В глазах ~~курильщика~~ Ли же, которая видимо считает, что $(a+b)^2 = b^2 + 2ab + a^2$, эта формула выглядит как
$$(a+ b)^n = \sum_{k=0}^n \binom nk a^k b^{n-k}$$
$\binom nk$ здесь равно $C^k_n$, и зовется *биномиальным коэффициентом* из [прошлого билета][[[3,0,15]]].

Например:
$$(a+b)^3 = \sum_{k=0}^3 \binom nk a^k b^{n-k} = \binom 30 a^0b^3 + \binom 31 a^1b^2 + \binom32 a^2b^1 + \binom33a^3b^0$$
$$(a+b)^3 = b^3 + 3ab^2 + 3a^2b + a^3$$
Чтобы проще раскладывать бином Ньютона, можно использовать треугольник Паскаля - коэффициенты разложения суммы $n$-ной степени находятся на $n+1$-ой строчке треугольника Паскаля.
![[https://upload.wikimedia.org/wikipedia/commons/4/49/Треугольник_Паскаля.svg]]

При раскрытии скобки суммы $n$-ной степени, мы из каждой скобки произведения выбираем либо первое слагаемое, либо второе. После раскрытия всех скобок, сколько будет членов $a^k b^{n-k}$? Чтобы получить такой член при раскрытии скобок, нужно выбрать левый член в $k$ скобках, и в оставшихся $n-k$ выбрать правый член. Количество таких выборов и есть количество сочетаний $k$ по $n$ - и равно оно $C^k_n$.

## Свойства числа сочетаний
Число сочетаний симметрично:
$$C^k_n = C^{n-k}_n$$
Это можно объяснить коммутативностью произведения:
$$C^k_n = \frac{n!}{k!(n-k)!} = \frac{n!}{(n-k)!k!} = C^{n-k}_n$$
Коэффициенты можно вынести за скобки:
$$C^k_n = \frac{n!}{k!(n-k)!} = \frac{n (n-1)!}{k(k-1)!((n-1)-(k-1))!} = \frac{n}k C^{k-1}_{n-1}$$

Сумма всех сочетаний от 0 до $n$ равна $2^n$:
$$\sum_{k=0}^n C^k_n = 2^n$$
Это показывается представлением $2^n$ как $(1+1)^n$, и тогда все множители $a^k$ и $b^{n-1}$ будут равны единице.
$$2^n=(1+1)^n = \sum_{k=0}^n C^k_n 1^k 1^{n-k} = \sum_{k=0}^n C^k_n$$
Это равенство имеет и комбинаторный смысл, так как $C^k_n$ - это число всех подмножеств мощности $k$ множества мощностью $n$, а $2^n$ - это мощность булеана этого множества.

И одно из наиболее важных свойств - свойство суммы числа сочетаний:
$$C^k_{n+1} = C^{k-1}_{n} + C^k_{n}$$
Это свойство можно видеть через бином Ньютона:
$$(a+b)^{n+1} = (a+b)(a+b)^n$$
Коэффициент $a^k\cdot b^{n+1-k}$ в левой части можно получить при умножении скобки справа двумя способами:
- Выбрать в первой скобке $a$, тогда нужный коэффициент получится при умножении $a$ на $a^{k-1} \cdot b^{n+1-k}$ из правой скобки. При этом коэффициенте стоит биномиальный коэффициент $C^{k-1}_n$.
- Выбрать в первой скобке $b$, значит в правой должен быть $a^k \cdot b^{n-k}$. При этом коэффициенте стоит биномиальный коэффициент $C^k_n$.

Получается, в левой части равенства для этого члена будет стоять сумма первого и второго способа получения этого коэффициента, что показывает истинность формулы.

Но эта формула полагается на истинность бинома Ньютона, а для индуктивного доказательство такое не пойдет. Эту формулу можно доказать алгебраически:

$$C^{k-1}_n + C^k_n = \frac{n!}{(k-1)!(n-k+1)!} + \frac{n!}{k!(n-k)!} = $$
Раскрываем факториалы в знаменателях с целью привести дроби к одному знаменятелю:
$$=\frac{n!}{(k-1)!(n-k+1)(n-k)!} + \frac{n!}{k(k-1)!(n-k)!}=$$
Приводим к одному знаменателю:
$$=\frac{n! \cdot (k + (n-k+1))}{k(n-k+1)(k-1)!(n-k)!}=\frac{n! \cdot (n+1)}{k(n-k+1)(k-1)!(n-k)!}=$$
Теперь сворачиваем факториалы по правилу $(n+1)! = (n+1)n!$:
$$=\frac{(n+1)!}{k!(n-k+1)!} = \frac{(n+1)!}{k!((n+1)-k)!} = C^k_{n+1}$$
## Индукция
Спундер не был бы спундером, если бы тут не было индуктивного доказательства бинома Ньютона.
Возьмем базу индукции за $n=0$: $(x+y)^0 = 1$.
Шаг индукции: предположим, что бином Ньютона верен для $n$, тогда для $n+1$:
$$(x+y)^{n+1} = (x+y)(x+y)^n$$
$$(x+y)(x+y)^n = (x+y)\sum_{k=0}^{n} C^k_n \cdot x^{k}y^{n-k} =$$
По закону дистрибутивности для конечных сумм:
$$ = x\sum_{k=0}^{n} C^k_n \cdot x^{k}y^{n-k} + y\sum_{k=0}^{n} C^k_n \cdot x^{k}y^{n-k} = $$
$$ = \sum_{k=0}^{n} C^k_n \cdot x^{k+1}y^{n-k} + \sum_{k=0}^{n} C^k_n \cdot x^{k}y^{n-k+1}$$
Вводим замену на левую часть $k' = k+1$, или же, $k = k'-1$:
$$\sum_{k=0}^{n} C^k_n \cdot x^{k+1}y^{n-k} = \sum_{k'=1}^{n+1} C^{k'-1}_{n} \cdot x^{k'}y^{n-k'+1}$$
Мы вычли 1 из каждого $k$, и сдвинули сумму на 1 вправо, чтобы количество слагаемых не изменилось.
Вычленим последний элемент из первого слагаемого, и первый элемент из второго слагаемого.

Первое слагаемое:
$$ \sum_{k'=1}^{n+1} C^{k'-1}_{n} \cdot x^{k'}y^{n-k'+1} = x^{n+1} + \sum_{k'=1}^{n} C^{k'-1}_{n} \cdot x^{k'}y^{n-k'+1}$$
Второе слагаемое:
$$\sum_{k=0}^{n} C^k_n \cdot x^{k}y^{n-k+1} = y^{n+1} + \sum_{k=1}^{n} C^k_n \cdot x^{k}y^{n-k+1}$$
Складываем оставшиеся правую и левую части суммы вместе:
$$\sum_{k=1}^{n} C^k_n \cdot x^{k}y^{n-k+1} + \sum_{k'=1}^{n} C^{k'-1}_{n} \cdot x^{k'}y^{n-k'+1} = $$
Используя дистрибутивный закон и свойство суммы биномиальных коэффициентов, получаем:
$$=\sum_{k',k=1}^{n} (C^{k'-1}_{n} + C^k_n)x^{k'}y^{n-k'+1} = \sum_{k=1}^{n} C_{n+1}^k \cdot x^{k}y^{n-k+1}$$
Итого, не забывая вычленные члены в начале, получаем, что $(x+y)(x+y)^n$ равно:
$$x^{n+1} + \sum_{k=1}^{n} C_{n+1}^k \cdot x^{k}y^{n-k+1} + y^{n+1}$$
Теперь мы можем занести отдельные члены под знак суммы (ведь коэффициенты при них равны $1 = C^0_{n+1} = C^{n+1}_{n+1}$):
$$(x+y)^{n+1} = \sum_{k=0}^{n+1} C_{n+1}^k \cdot x^{k}y^{n-k+1}$$
Ч.т.д... К счастью, я не думаю что для дискры это доказательство важно знать наизусть, скорее важно комбинаторное понимание этой формулы.
