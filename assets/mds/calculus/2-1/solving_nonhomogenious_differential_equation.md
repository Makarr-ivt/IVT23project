[Mathprofi - неоднородные дифференциальные уравнения](http://mathprofi.ru/kak_reshit_neodnorodnoe_uravnenie_vtorogo_poryadka.html)

[Mathprofi - подбор частного решения](http://mathprofi.ru/kak_podobrat_chastnoe_reshenie_dy.pdf)

[Mathprofi - вариация произвольных переменных](http://mathprofi.ru/metod_variacii_proizvolnyh_postoyannyh.html)

[Mathprofi - линейные дифференциальные уравнения высших порядков](http://mathprofi.ru/metod_variacii_proizvolnyh_postoyannyh.html)

$$y''-4y'+4y=16e^{-2x}, \ \ \ y(0)=16, \ \ y'(0) = 0$$
Решение неоднородных уравнений делится на три шага:
1. Решаем однородное уравнение
2. Находим частное решение неоднородного уравнения
3. Складываем + решаем задачу Коши при надобности

## Шаг первый - однородное уравнение
Откидываем правую часть с $x$ и оставляем только
$$y'' - 4y' + 4y = 0$$
Чтобы решить такое уравнение, нужно решить соответствующее характеристическое уравнение:
$$\lambda^2 - 4\lambda + 4=0$$
Составляется элементарно - вместо степени производной у нас просто степени, вместо $y$ ставим $\lambda$. Находим его корни.
$$\lambda_{1,2} = 2$$
Для корней мы составляем общее решение уравнения: для каждого корня уравнения мы прибавляем член $Ce^{\lambda x}$. В случае, если корни кратные, для каждой степени корня мы умножаем этот член на $x$. Получаем для корней следующее решение:
$$y_0(x) = C_1e^{2x} + C_2xe^{2x}$$
Например, были бы корни $\lambda_1 = 2, \lambda = 3$, получили бы
$$C_1 e^{2x} + C_2e^{3x}$$
Были бы $\lambda_{1,2,3} = 5, \lambda_4 = -3$:
$$C_1e^{5x} + C_2xe^{5x} + C_3x^2e^{5x} + C_4e^{-3x}$$
Надеюсь, уловили закономерность.

## Шаг 2 - частное решение
Чтобы найти частное решение, нужно для начала понять, а в какой форме это решение вообще будет. Когда справа решение в простой форме - обычная экспонента, многочлен, или синусы/косинусы - решение можно "угадать".
Для случаев, когда справа стоит просто экспонента, возможно умноженная на какой-то многочлен, частное решение выглядит как:
$$y_1(x) = x^s \cdot e^{\gamma x}(b_0 + b_1x + b_2x^2 + \ldots + b_mx^m)$$
Здесь три параметра, за которыми следим:
- $\gamma$ - это степень при экспоненте в правой части. Для $e^{3x}:$ $\gamma=3$, для $e^{-5x}: \gamma =-5$ и т.д. В нашем случае $\gamma = -2$.
- $m$ - степень при максимальной степени многочлена, умножаемого на экспоненту. При $xe^{x}: m=1$, при $(x^3-1)e^x: m=3$, и т.д. В нашем случае же ничего на экспоненту (кроме константы) не умножается, поэтому $m=0$.
- $s$ - кратность корня $\gamma$ в $\lambda$. Если $\gamma =-2$, то при $\lambda = \set{-2,2}: s = 1$, при $\lambda=\set{1,2}: s=0$, при $\lambda=\set{-2,-2, 3}: s=2$ и т.д. В нашем случае $-2$ не входит в корни характеристического уравнения, поэтому $s = 0$.

>[!note] Когда есть нулевые корни
>В случае наличия нулевых корней ($\lambda=0$), необходимо в конце умножить частное решение на $x^p$, где $p$ - кратность нулевого корня. Изначально нулевые корни появляются, ибо в дифференциальном уравнении коэффициент при $y$ был равен нулю:
>$$Ay'' - By' = f(x)$$
>В таком случае можно было проинтегрировать обе части уравнения, и пришли бы к
>$$Ay' - By = \int f(x) \dd x + C$$
>Если $f(x)$ находится в форме $e^{\gamma x}(A+Bx+Cx^2+\ldots)$, то при интеграции $f(x)$ просто умножится на $C_1x$, где $C_1$ это константа. Грубо говоря, отсюда и появляется это домножение на $x$.
>
>Поэтому если вы не хотите думать про дополнительные домножения, приведите свое дифференциальное уравнение к стандартному виду проинтегрировав его пару раз, так чтобы все коэффициенты при $y$ и его производных не равны нулю.

Составляем частное уравнение:
$$y_1(x) = b_0 e^{-2x} = C_3e^{-2x}$$
Теперь цель - найти этот коэффициент $C_3$. Для этого подставляем его с изначальное дифференциальное уравнение и решаем для $C_3$:
$$\array{y_1(x) = C_3e^{-2x} \\ y_1'(x) = -2C_3 e^{-2x} \\ y_1''(x) = 4C_3e^{-2x}}$$
Подставляем:
$$4C_3e^{-2x} +8C_3e^{-2x} + 4C_3e^{-2x} = 16e^{-2x} \Rightarrow C_3 = 1$$

## Шаг третий - завершаем грязную работу
Константа найдена, частное и общее решение есть. Теперь просто подставляем и складываем - и получаем решение дифференциального уравнения:
$$y(x) = C_1e^{2x} + C_2xe^{2x} + e^{-2x}$$
Теперь решаем задачу Коши. Сначала найдем производную (не забываем про производную произведения!):
$$y'(x) = 2C_1e^{2x} + 2C_2xe^{2x} + C_2e^{2x} -2e^{-2x}$$
И подставляем условия:
$$y(0)=16: 16 = C_1e^{2\cdot 0} + C_2 \cdot 0 \cdot e^{2\cdot 0} + e^{-2 \cdot 0} \Rightarrow C_1 = 15$$
$$y'(0) = 0: 0=2\cdot 15 \cdot e^{0} + 2C_2 \cdot 0 \cdot e^0 + C_2 e^0 - 2e^0 \Rightarrow C_2 = -28$$
И, наконец, получаем решение задачи Коши:
$$y(x) = 15e^{2x} - 28xe^{2x} + e^{-2x}$$
По итогу, самое сложное в этой задаче - найти частное решение. Но "угадывать" - не единственный способ это делать!

## Вариация с тригонометрическими функциями
$$y''-5y'+6y=-x\sin x$$
Быстренько пройдемся через первый шаг:
$$\array{y'' - 5y'+6y=0 \\ \lambda^2 - 5\lambda + 6=0 \Rightarrow \lambda_1 = 2, \lambda_2 = 3 \\ y_0(x) = C_1e^{2x} + C_2e^{3x}}$$
Теперь самое интересное, второй шаг - делаем частное решение. Для этого надо прикинуть, а как будет выглядеть частное решение с синусами/косинусами? Тут точно так же собираем $\gamma, m, s$ параметры, правда с тригонометрическими функциями имеет смысл разделить $\gamma$ как $\alpha \pm i \beta$: $\alpha$ это показатель степени в экспоненте, а $\beta$ - множитель $x$ у синусов и косинусов. В нашем случае, $\gamma = 0\pm 1i$. $m$ остается как было, здесь $m=1$ (ибо умножается на $x$ и $x^2$ нигде нет), и $s$ - кратность $\gamma$ среди $\lambda$ + кратность нуля среди $\lambda$. Но $\gamma$ комплексная, а корни у нас действительные, поэтому $s=0$.
Общая форма выглядит так:
$$\array{y_1(x) = x^s \cdot e^{\alpha x}\big[(b_0 + b_1x + \ldots +b_mx^m) \sin \beta x + \ \\ \ +(c_0 + c_1x + \ldots +c_mx^m) \cos \beta x\big]}$$
Значит для наших значений, частное решение будет выглядеть так:
$$y_1(x) = (C_3x+C_4)\sin x + (C_5x+C_6)\cos x$$
Дальше можно пойти считать производные и подставлять, находить коэффициенты, но это уже дело упорства и техники, и к способу решения не относится - поэтому я все это пропущу ;p

## Комплексные корни
$$y''+4y=e^{2x}$$
Идея не сложная, просто если столкнуться с таким без подготовки можно растеряться.
Как обычно, решаем однородное:
$$\array{y'' + 4y=0 \\ \lambda^2 + 4 = 0 \\ \lambda = \pm 2i \\ y_0(x) = C_1e^{2ix} + C_2e^{-2ix}}$$
И на этом шаге просто применяем формулу Эйлера:
$$e^{ix} = \cos x + i\sin x$$
$$\array{y_0(x) = C_1(\cos 2x + i\sin 2x) + C_2(\cos -2x + i\sin -2x) = \\ =C_1(\cos 2x + i\sin 2x) + C_2(\cos 2x -i\sin 2x)=\\=C_1\cos 2x + C_1i\sin 2x + C_2\cos 2x - C_2i\sin 2x = \\ (C_1+C_2)\cos 2x - i(C_1-C_2)\sin 2x}$$
В этот момент мы можем переопределить константы: $C_1 + C_2$ и $i(C_1-C_2)$ - это тоже константы, и мы можем назвать их новыми $C_1$ и $C_2$, однако эти константы уже принадлежат комплексному множеству: $C_1, C_2 \in \mathbb C$
$$y_0(x) = C_1\cos 2x + C_2 \sin 2x$$
Ну а остальное решение особо трудностей не вызывает. Колдуем частное решение: для $e^{2x}$ параметры будут $\gamma = 2$, $m=0$, $s=0$ (корни комплексные вообще):
$$\array{y_1(x) = C_3e^{2x} \\ y_1'(x) = 2C_3e^{2x} \\ y_1''(x) = 4C_3e^{2x}}$$
Подставляем и решаем:
$$4C_3e^{2x} + 4C_3e^{2x} = e^{2x} \Rightarrow C_3 = \frac18$$
Ответ:
$$y(x) = y_0 + y_1 = C_1\cos 2x + C_2 \sin 2x + \frac{e^{2x}}8, \ \ \ \ \ C_1, C_2 \in \mathbb C$$

## Метод вариации постоянных
Идея: решаем однородное уравнение и получаем множество констант. Затем мы подумаем, что эти константы зависят от $x$ - и превратим их в функции. Подставляя такие функции-константы в неоднородное уравнение мы сможем получить решение.
Покажем на примере обычного неоднородного уравнения:
$$x^2y'+xy+1=0$$
Делим на $x^2$ ($x=0$ не является решением), чтобы оставить $y'$ без коэффициента, и приводим к стандартному виду неоднородного уравнения:
$$y' +\frac yx = -\frac{1}{x^2}$$
Отбрасываем правую часть, и решаем однородное уравнение:
$$\frac{\dd y}{\dd x} + \frac{y}x = 0 \Rightarrow \frac{\dd y}y  = - \frac{\dd x}x \Rightarrow y = \frac{C}x, \ \ \ \ C \in \mathbb R$$
Начинается вариация постоянной - представляем $C$ как $u(x)$:
$$y = \frac{u(x)}x$$
И теперь такое выражение подставляем в изначальное неоднородное уравнение:
$$y' = \frac{xu'(x)-u(x)}{x^2}$$
$$xu'(x)-u(x) + u(x) + 1 = 0 \Leftrightarrow xu'(x) = -1$$
И теперь решаем это уравнение - оно тоже простенькое:
$$u'(x) = -\frac{1}{x} \Rightarrow u(x) = -\ln |x| + C, \ \ \ C \in \mathbb R$$
Подставляем $u(x)$ обратно и получаем ответ под $y$:
$$y = \frac{C - \ln |x|}{x}$$

### Высшие порядки
С уравнениями высших порядков способ становится слегка сложнее:
$$y''-6y'+8y=4e^{2x}$$
Первый шаг неизменный - решаем однородное и получаем константы, которые будем варьировать:
$$\array{y'' -6y' + 8y=0 \\ \lambda^2 - 6\lambda + 8 = 0 \\ \lambda_1 = 2, \lambda_2 = 4 \\ y_0(x) = C_1e^{2x} + C_2e^{4x}}$$
Второй шаг: превращаем константы в функции и составляем систему уравнений:
$$\cases{C_1'(x) (e^{2x}) + C_2'(x)(e^{4x}) = 0 \\ C_1'(x)(e^{2x})' + C_2'(x)(e^{4x})' = 4e^{2x}}$$
В общем виде выглядит это примерно так:
$$\cases{C_1'(x)f_1(x) + C_2'(x)f_2(x) + \ldots + C_n'(x)f_n(x) = 0 \\ C_1'(x)f_1'(x) + C_2'(x)f_2'(x) + \ldots + C_n'(x)f_n'(x) = 0 \\ \ldots \\ C_1'(x)f_1^{(n-1)}(x) + C_2'(x)f_2^{(n-1)}(x) + \ldots + C_n'(x)f_n^{(n-1)}(x) = \frac{f(x)}{a(x)}}$$
$f_1, f_2, \ldots$ - функции, стоящие при константах в общем решении. Мы составляем $n$ уравнений (для $n$ функций), где умножаем производную каждой константы на какую-то производную рядом с ней стоящей функции. Все строчки, кроме последней, равны нулю. Последняя же равна $f(x)$ - той функции справа, которую мы отбрасываем когда решаем однородное уравнение. Делим ее на $a(x)$ - коэффициент при максимальной производной $y$ в изначальном уравнении. Но обычно $a(x) = 1$.

Давайте решать систему - это система "линейных" уравнений, только тут функции. Однако метод Крамера (да и любой другой) спокойно здесь применяется.
Найдем определитель:
$$|A| = \left|\array{e^{2x} & e^{4x} \\ 2e^{2x} & 4e^{4x}}\right| = 4e^{2x}e^{4x} - 2e^{2x}e^{4x} = 2e^{6x} \neq 0$$
Значит система имеет единственное решение. Считаем определители для метода Крамера, заменяя каждый столбик столбиком равенства справа.
$$|A_1| = \left|\array{0 & e^{4x} \\ 4e^{2x} & 4e^{4x}}\right| = -4e^{6x}$$
$$|A_2| = \left|\array{e^{2x} & 0 \\ 2e^{2x} & 4e^{2x}}\right| = 4e^{4x}$$
Находим производные функций:
$$C_1' (x) = \frac{|A_1|}{|A|} = -\frac{4e^{6x}}{2e^{6x}} = -2$$
$$C_2' (x) = \frac{|A_2|}{|A|} = \frac{4e^{4x}}{2e^{6x}} = 2e^{-2x}$$
Чтобы найти оригиналы констант, нужно проинтегрировать функции:
$$C_1(x) = \int -2 \dd x = -2x + C_1$$
$$C_2(x) = \int 2e^{-2x} \dd x = -e^{-2x} + C_2$$
Подставляем эти константы в общее решение однородного уравнения и получаем общее решение неоднородного!
$$\array{y(x) = (-2x + C_1)e^{2x} + (-e^{-2x}+C_2)e^{4x} \\ = -2xe^{2x} + C_1e^{2x} - e^{2x} + C_2e^{4x} = \\ =-2xe^{2x} + (C_1-1)e^{2x}+C_2e^{4x} = \\ = -2xe^{2x} + C_1e^{2x} + C_2e^{4x}}$$
Этот метод решения более техничный, но и работает с большей выборкой видов уравнений. "Угадывание" решения работает только когда $f(x)$ - функция определенного вида.

